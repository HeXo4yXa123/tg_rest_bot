<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>Mini App</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
:root{
  --bg:#0A0A09;
  --card:#1A1A18;
  --accent:#21EA7C;
  --text:#fff;
  --muted:#8A8A8A;
}

*{box-sizing:border-box}

body{
  margin:0;
  padding:16px;
  padding-bottom:96px;
  background:var(--bg);
  font-family:-apple-system,BlinkMacSystemFont,system-ui,sans-serif;
  color:var(--text);
}

/* ---------- CARDS ---------- */
.card{
  background:linear-gradient(180deg,#1C1C1A,#141412);
  border-radius:18px;
  padding:16px;
  margin-bottom:12px;
}

/* ---------- PROFILE HEADER ---------- */
.profile-header{
  display:flex;
  gap:12px;
  align-items:center;
}

.avatar{
  width:48px;
  height:48px;
  border-radius:50%;
  background:#C77DFF;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
}

/* ---------- LIST ---------- */
.list{
  list-style:none;
  padding:0;
  margin:0;
}

.list li{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px 0;
  border-bottom:1px solid #2A2A2A;
}

.list li:last-child{border-bottom:none}

.item{
  display:flex;
  gap:12px;
  align-items:center;
}

.icon{
  width:22px;
  height:22px;
  stroke:var(--accent);
}

/* ---------- EMPTY CART ---------- */
.cart-empty{
  height:70vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
}

.cart-icon{
  width:140px;
  margin-bottom:24px;
}

button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:16px;
  background:var(--accent);
  color:#000;
  font-weight:600;
  margin-top:16px;
}

/* ---------- BOTTOM NAV ---------- */
.bottom-nav{
  position:fixed;
  left:0;
  right:0;
  bottom:0;
  background:#1A1A18;
  border-radius:18px 18px 0 0;
  padding:10px 0;
  display:flex;
}

.nav-item{
  flex:1;
  text-align:center;
  font-size:12px;
  color:var(--muted);
}

.nav-item.active{color:var(--accent)}

.nav-item svg{
  width:26px;
  height:26px;
  display:block;
  margin:0 auto 4px;
  stroke:currentColor;
}
</style>
</head>

<body>

<div id="content"></div>

<div class="bottom-nav">
  <div class="nav-item" data-tab="home">üè†<br>–ì–ª–∞–≤–Ω–∞—è</div>
  <div class="nav-item" data-tab="fav">‚ô°<br>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</div>
  <div class="nav-item active" data-tab="cart">üõç<br>–ö–æ—Ä–∑–∏–Ω–∞</div>
  <div class="nav-item" data-tab="profile">üë§<br>–ü—Ä–æ—Ñ–∏–ª—å</div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();

const SUPABASE_URL = "https://urpxgkdzvzvxvykhusxo.supabase.co";
const SUPABASE_KEY = "PASTE_YOUR_KEY";

const content = document.getElementById("content");
const nav = document.querySelectorAll(".nav-item");
const user = tg.initDataUnsafe.user || {id:0,first_name:"User"};

nav.forEach(n=>{
  n.onclick=()=>{
    nav.forEach(x=>x.classList.remove("active"));
    n.classList.add("active");
    render(n.dataset.tab);
  };
});

function render(tab){
  if(tab==="cart"){
    content.innerHTML=`
      <div class="cart-empty">
        <svg class="cart-icon" viewBox="0 0 200 200">
          <rect x="40" y="60" width="120" height="100" rx="12" fill="#E8FFF1"/>
          <circle cx="80" cy="100" r="8" fill="#21EA7C"/>
          <circle cx="120" cy="100" r="8" fill="#21EA7C"/>
        </svg>
        <h3>–ü–æ—Ö–æ–∂–µ, —Ç—É—Ç –Ω–∏—á–µ–≥–æ –Ω–µ—Ç..</h3>
        <p class="muted">–ü–æ–∫–∞ —á—Ç–æ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
        <button onclick="createOrder()">–°–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑</button>
      </div>
    `;
  }

  if(tab==="profile"){
    content.innerHTML=`
      <div class="card profile-header">
        <div class="avatar">${user.first_name[0]||"A"}</div>
        <div>
          <b>${user.first_name}</b><br>
          <span class="muted">ID ${user.id}</span>
        </div>
      </div>

      <div class="card">
        <ul class="list">
          <li><div class="item"><span class="icon">‚ô°</span>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</div><span style="color:var(--accent)">‚Ä∫</span></li>
          <li><div class="item"><span class="icon">üìç</span>–ú–æ–∏ –∞–¥—Ä–µ—Å–∞</div><span style="color:var(--accent)">‚Ä∫</span></li>
          <li><div class="item"><span class="icon">üßæ</span>–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</div><span style="color:var(--accent)">‚Ä∫</span></li>
          <li><div class="item"><span class="icon">üí≥</span>–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã</div><span style="color:var(--accent)">‚Ä∫</span></li>
        </ul>
      </div>

      <div class="card">
        <ul class="list">
          <li><div class="item">üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞</div><span style="color:var(--accent)">‚Ä∫</span></li>
          <li><div class="item">üë• –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞</div><span style="color:var(--accent)">‚Ä∫</span></li>
          <li><div class="item">ü§ù –°—Ç–∞—Ç—å –ø–∞—Ä—Ç–Ω—ë—Ä–æ–º</div><span style="color:var(--accent)">‚Ä∫</span></li>
        </ul>
      </div>

      <div class="card">
        <ul class="list">
          <li><div class="item">‚ÑπÔ∏è –û —Å–µ—Ä–≤–∏—Å–µ</div><span style="color:var(--accent)">‚Ä∫</span></li>
          <li><div class="item">üåê –Ø–∑—ã–∫</div><span class="muted">–†—É—Å—Å–∫–∏–π</span></li>
        </ul>
      </div>

      <div class="card">
        ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
        <p class="muted">–†–∞–∑–¥–µ–ª –ø–æ–∫–∞ –ø—É—Å—Ç—É–µ—Ç</p>
      </div>
    `;
  }
}

async function createOrder(){
  await fetch(`${SUPABASE_URL}/rest/v1/orders`,{
    method:"POST",
    headers:{
      apikey:SUPABASE_KEY,
      Authorization:`Bearer ${SUPABASE_KEY}`,
      "Content-Type":"application/json"
    },
    body:JSON.stringify({
      telegram_id:user.id,
      status:"new"
    })
  });
  alert("–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω");
}

render("cart");
</script>

</body>
</html>
